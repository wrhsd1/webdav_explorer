# 播放列表保存和加载功能使用说明

## 🎵 新功能概述

本次更新为WebDAV文件管理器的音乐播放器添加了播放列表保存和加载功能，让您可以：

1. **保存当前播放列表**到WebDAV存储空间
2. **加载已保存的播放列表**
3. **管理播放列表**（重命名、删除）

## 📝 详细功能说明

### 1. 保存播放列表

#### 如何保存：
1. 在文件管理器中添加音乐文件到播放列表
2. 点击播放列表面板中的"💾 保存列表"按钮
3. 在弹出的对话框中输入播放列表名称（可选）
4. 点击"保存"按钮

#### 保存规则：
- **默认名称格式**：如果不输入名称，将自动使用`播放列表_YYYYMMDDHHMM`格式（北京时间）
- **存储位置**：播放列表文件保存在当前WebDAV账户的`web_PLAYLIST`文件夹中
- **文件格式**：使用JSON格式，文件扩展名为`.json`
- **重名处理**：如果文件名已存在，会自动添加序号后缀

#### 保存内容包括：
- 播放列表名称
- 所有音乐文件的路径和名称
- 创建时间（北京时间）
- 关联的WebDAV账户信息

### 2. 加载播放列表

#### 如何加载：
1. 点击播放列表面板中的"📂 加载列表"按钮
2. 在播放列表选择界面中浏览可用的播放列表
3. 点击想要加载的播放列表的"📂"按钮

#### 加载特性：
- **自动检测**：系统会自动扫描`web_PLAYLIST`文件夹中的所有播放列表文件
- **替换模式**：加载新播放列表会替换当前播放列表
- **播放状态**：加载后会停止当前播放，需要手动开始播放新列表
- **显示信息**：每个播放列表显示歌曲数量和创建时间

### 3. 播放列表管理

#### 重命名播放列表：
1. 在播放列表选择界面点击"✏️"按钮
2. 输入新的播放列表名称
3. 点击"重命名"确认

#### 删除播放列表：
1. 在播放列表选择界面点击"🗑️"按钮
2. 确认删除操作

#### 刷新列表：
- 点击"🔄 刷新"按钮可以重新扫描最新的播放列表文件

## 🔧 技术实现

### 目录结构
```
WebDAV根目录/
└── web_PLAYLIST/          # 播放列表存储目录（自动创建）
    ├── 我的音乐_202509101125.json
    ├── 流行歌曲_202509101200.json
    └── 轻音乐_202509101230.json
```

### 播放列表文件格式
```json
{
    "name": "我的音乐",
    "tracks": [
        {
            "path": "/music/song1.mp3",
            "name": "歌曲名称1.mp3",
            "id": 1725960700123.456
        },
        {
            "path": "/music/song2.mp3", 
            "name": "歌曲名称2.mp3",
            "id": 1725960700124.789
        }
    ],
    "created_at": "2025-07-09 11:25:00",
    "account": "account_key",
    "version": "1.0"
}
```

## 📱 移动端适配

### 响应式设计
- 播放列表控制按钮在移动端采用网格布局
- 模态框在小屏幕上优化显示
- 触摸友好的按钮大小

### 移动端特色功能
- 保存和加载模态框支持触摸滚动
- 播放列表预览区域适配小屏幕
- 按钮布局针对移动端优化

## 🛡️ 安全特性

### 数据安全
- 所有播放列表文件仅存储在用户自己的WebDAV空间
- 支持多用户，每个用户只能访问自己的播放列表
- 路径验证确保文件只能保存在指定目录

### 文件名安全
- 自动过滤特殊字符，确保文件名安全
- 防止路径遍历攻击
- 限制文件操作范围在`web_PLAYLIST`目录内

## 🔄 兼容性

### 向后兼容
- 原有的播放列表功能完全保持不变
- 本地存储的播放列表状态仍然有效
- 不影响现有的音乐播放功能

### 跨设备同步
- 播放列表保存在WebDAV服务器上，可以在不同设备间同步
- 支持多个WebDAV账户，每个账户的播放列表独立管理

## 🎯 使用建议

### 最佳实践
1. **定期保存**：为常用的播放列表创建保存版本
2. **命名规范**：使用有意义的名称便于管理
3. **分类管理**：可以按音乐类型、心情等创建不同的播放列表
4. **备份重要列表**：对于精心制作的播放列表及时保存

### 注意事项
1. **网络要求**：保存和加载功能需要WebDAV连接正常
2. **存储空间**：播放列表文件通常很小，不会占用太多空间
3. **权限要求**：确保WebDAV账户有创建文件夹和上传文件的权限
4. **文件路径**：播放列表中保存的是文件路径，移动或删除原文件会影响播放

## 🚀 未来扩展

计划中的功能改进：
- 播放列表导入/导出功能
- 播放列表分享功能
- 自动生成推荐播放列表
- 播放统计和分析功能

---

**更新时间**：2025年7月9日  
**版本**：v1.0  
**兼容性**：支持所有现代浏览器，移动端友好
